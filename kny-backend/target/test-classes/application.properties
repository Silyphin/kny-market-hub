# Test Database Configuration - H2 In-Memory (No MySQL needed!)
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA Configuration for Testing
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.open-in-view=false

# CRITICAL: Disable OAuth2 auto-configuration (main cause of test failures)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.oauth2.client.OAuth2ClientAutoConfiguration

# Mock OAuth2 Configuration (for tests that need OAuth2 beans)
spring.security.oauth2.client.registration.google.client-id=test-google-client-id
spring.security.oauth2.client.registration.google.client-secret=test-google-client-secret
spring.security.oauth2.client.registration.facebook.client-id=test-facebook-client-id
spring.security.oauth2.client.registration.facebook.client-secret=test-facebook-client-secret

# CORS Configuration - All required properties (matching your CorsConfig)
app.cors.allowed-origins=http://localhost:3000,http://localhost:8080,http://127.0.0.1:3000
app.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
app.cors.allowed-headers=*
app.cors.allow-credentials=true
app.cors.max-age=3600

# External API Configuration (Mock values for testing)
app.google.maps.api.key=test-api-key
app.google.maps.geocoding.url=https://maps.googleapis.com/maps/api/geocode/json
app.google.maps.places.url=https://maps.googleapis.com/maps/api/place

# Weather API Configuration (Mock values)
app.openmeteo.api.url=https://api.open-meteo.com/v1/forecast
app.weather.default.latitude=5.4164
app.weather.default.longitude=100.3327
app.weather.forecast.days=7
app.weather.timezone=Asia/Kuala_Lumpur

# JWT Configuration (Mock values for testing)
app.jwt.secret=test-jwt-secret-for-testing-purposes-only
app.jwt.expiration=86400000
app.jwt.refresh-expiration=604800000
app.jwt.issuer=kny-market-hub-test
app.jwt.audience=kny-users-test

# Facebook API Configuration (Mock values)
app.facebook.api.version=v18.0
app.facebook.graph.url=https://graph.facebook.com

# Logging Configuration (Reduce noise in tests)
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.com.kny=INFO
logging.level.org.hibernate.SQL=WARN

# Test specific configurations
spring.main.allow-bean-definition-overriding=true
server.port=0

# Session Configuration for Tests
server.servlet.session.timeout=5m

# JSON Configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=Asia/Kuala_Lumpur
spring.jackson.default-property-inclusion=NON_NULL

# Disable web security for easier testing
spring.main.web-application-type=servlet